DANUBIC_create_danubic_array = {
	every_country = {
		limit = {
			DANUBIC_is_danubic = yes 
		}
		add_to_array = {
			array = PREV.DANUBIC_array 	
		}
	}
	for_each_scope_loop = {
		array = DANUBIC_array
		log = "[THIS.GetName] is part of Danubia"
	}
}

DANUBIC_create_danubic_alliance = {
	#if = {
	#	limit = {
	#		NOT = { has_rule = can_create_factions }
 	#	}
 	#	set_rule = { 
 	#		can_create_factions = yes
 	#	}
	#}
	set_variable = {global.danubic_faction_creator = ROOT }
	if = {
		limit = { # Little Entente
			AND = {
				DANUBIC_is_democratic = yes 
				#DANUBIC_little_entente_viable = yes
			}
		}
		set_global_flag = DANUBIC_little_entente_alliance_formed
		set_country_flag = DANUBIC_li_leader 
		#set_faction_name = DANUBIC_li
		
		
	#	set_variable = {  = 0 }
	#	set_variable = {  = 0 }
	#	set_variable = {  = 0 }
	#	set_variable = {  = 0 }
	#	set_variable = {  = 0 }
	#	set_variable = {  = 0 }
	#	set_variable = {  = 0 }
	#	set_variable = {  = 0 }

	hidden_effect = {
		add_dynamic_modifier = { modifier = DANUBIC_li_leader_dmod }
		add_dynamic_modifier = { modifier = DANUBIC_daf_le_coop_dmod }
		add_to_variable = {
			DANUBIC_army_org_factor = -0.10
		}
		add_to_variable = {
			DANUBIC_consumer_goods_factor = 0.1
		}
		add_to_variable = {
			DANUBIC_dmod_production_speed_buildings_factor = 0.05
		}
		add_to_variable = {
			DANUBIC_dmod_dem_drift = 0.02
		}
		add_to_variable = {
			DANUBIC_dmod_pol_pw_gain = 0.2
		}
	}
		custom_effect_tooltip = DANUBIC_allied_council_le_tt
		every_other_country = {
			limit = {
				#DANUBIC_has_started_li_focus_tree = yes
				is_subject = no
				has_country_flag = CZE_ROM_agreement
				has_country_flag = CZE_YUG_agreement
				has_country_flag = ROM_YUG_agreement
			}
			DANUBIC_add_to_danubic_alliance = yes
			#add_dynamic_modifier = { modifier = DANUBIC_daf_le_coop_dmod }
		}
	}
	else_if = {
		limit = {
			DANUBIC_is_mon = yes 
		}
		set_global_flag = DANUBIC_cef_alliance_formed 
		set_country_flag = DANUBIC_cef_leader
		set_faction_name = DANUBIC_cef
		
	#	set_variable = { NORDIC_communist_alliance_leader_dmod_max_eff = 0 }
	#	set_variable = { NORDIC_communist_alliance_leader_dmod_max_planning = 0 }
	#	set_variable = { NORDIC_communist_alliance_leader_dmod_research = 0 }
	#	set_variable = { NORDIC_communist_alliance_leader_dmod_resource_penalty = 0 }
	#	set_variable = { NORDIC_democratic_alliance_member_dmod_max_eff = 0 }
	#	set_variable = { NORDIC_communist_alliance_member_dmod_max_planning = 0 }
	#	set_variable = { NORDIC_communist_alliance_member_dmod_research = 0 }
	#	set_variable = { NORDIC_communist_alliance_member_dmod_resource_penalty = 0 }

	hidden_effect = {
		add_dynamic_modifier = { modifier = DANUBIC_cef_leader_dmod }
		add_dynamic_modifier = { modifier = DANUBIC_daf_cea_coop_dmod }
		add_to_variable = {
			DANUBIC_army_org_factor = -0.10
		}
		add_to_variable = {
			DANUBIC_consumer_goods_factor = 0.1
		}
		add_to_variable = {
			DANUBIC_dmod_production_speed_buildings_factor = 0.05
		}
		add_to_variable = {
			DANUBIC_dmod_dem_drift = 0.02
		}
		add_to_variable = {
			DANUBIC_dmod_pol_pw_gain = 0.2
		}
	}
		custom_effect_tooltip = DANUBIC_allied_council_le_tt
		every_other_country = {
			limit = {
				DANUBIC_has_started_li_focus_tree = yes
				is_subject = no
			}
			DANUBIC_add_to_danubic_alliance = yes
		}
	}  
	set_variable = { global.DANUBIC_alliance_leader = ROOT } # Setting the alliance leader regardless of ideology 
}


DANUBIC_add_to_danubic_alliance = {  
	if = {
		limit = {
			NOT = { has_completed_focus = DANUBIC_allied_council }
		}
		complete_national_focus = DANUBIC_allied_council
	}
	if = {
		limit = {
			has_global_flag = DANUBIC_little_entente_alliance_formed
		}

	#	set_variable = { NORDIC_democratic_alliance_leader_dmod_research = 0 }
	#	set_variable = { NORDIC_democratic_alliance_leader_dmod_training_time = 0 }
	#	set_variable = { NORDIC_democratic_alliance_leader_dmod_prod_eff_start = 0 }
	#	set_variable = { NORDIC_democratic_alliance_leader_dmod_war_support = 0 }
	#	set_variable = { NORDIC_democratic_alliance_member_dmod_research = 0 }
	#	set_variable = { NORDIC_democratic_alliance_member_dmod_training_time = 0 }
	#	set_variable = { NORDIC_democratic_alliance_member_dmod_prod_eff_start = 0 }
	#	set_variable = { NORDIC_democratic_alliance_member_dmod_war_support = 0 }

		add_dynamic_modifier = { modifier = DANUBIC_li_member_dmod }

	}
	else_if = {
		limit = {
			has_global_flag = DANUBIC_cef_alliance_formed
		}		

	#	set_variable = { NORDIC_monarchist_alliance_leader_dmod_prod_eff_gain = 0 }
	#	set_variable = { NORDIC_monarchist_alliance_leader_dmod_construction = 0 }
	#	set_variable = { NORDIC_monarchist_alliance_leader_dmod_max_org = 0 }
	#	set_variable = { NORDIC_monarchist_alliance_leader_dmod_drift_defense = 0 }
	#	set_variable = { NORDIC_monarchist_alliance_member_dmod_prod_eff_gain = 0 }
	#	set_variable = { NORDIC_monarchist_alliance_member_dmod_construction = 0 }
	#	set_variable = { NORDIC_monarchist_alliance_member_dmod_max_org = 0 }
	#	set_variable = { NORDIC_monarchist_alliance_member_dmod_drift_defense = 0 }

		add_dynamic_modifier = { modifier = DANUBIC_cea_member_dmod }
	}
}
